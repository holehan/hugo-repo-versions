{{- $version := float "NaN" -}}
{{ if eq .Params.repo "copr" }}
{{ $json := (getJSON .Params.jsonUrlPre .Params.jsonUrl) }}
{{- $version = index $json "builds" 0 "build" "package_version" -}}
{{- $version = index (findRE "(\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" $version) 0 -}}
{{ else if eq .Params.repo "snap" }}
{{- $json := getJSON "/data/snap/stable.json" -}}
{{- $version = $json.version -}}
{{ else if eq .Params.repo "snap-extended" }}
{{- $json := getJSON "/data/snap/extended.json" -}}
{{- $version = $json.version -}}
{{ else if eq .Params.repo "docker" }}
{{- $version = strings.TrimLeft "hugo:" (index (findRE "hugo:(\\d{1,3}\\.\\d{1,3}(\\.\\d{1,3})?)" (readFile "data/docker/build-images.sh")) 0) -}}
{{ else if eq .Params.repo "minimaldocker" }}
{{- $version = strings.TrimLeft "ARG VERSION=" (index (findRE "ARG VERSION=(\\d{1,3}\\.\\d{1,3}(\\.\\d{1,3})?)" (readFile "data/docker/Dockerfile-base")) 0) -}}
{{ end }}
{{- $version -}}
